################
install_pent_utils() {
    echo '############### installing pentest utils ###############'
    while read PEN_UTIL; do 
        if echo $PEN_UTIL | grep -q "#"; then
            continue
        fi
        util="$(echo $PEN_UTIL | $AWK -F"=" '{print $1}')"
        val="$(echo $PEN_UTIL | $AWK -F"=" '{print $2}')"
        if [[ "$util" == "enable_pentest_utils" ]]; then
            if [ "$val" -ne "1" ]; then
                echo
                echo "[+] you decided not to enable pentest utils being installed. Exiting."
                echo
                exit 1
            fi
        continue
        fi
        if [[ "$val" -eq "1" ]]; then
            sleep 1 && echo "[~] adding $util to pentest utils array .." && pentest_utils_array+=($util)
        fi
    done < $pentest_cfg_file

    return 0
}
################
install_sqlmap() {
    echo
    echo "[+] installing sqlmap .."
    echo
    ${APT} install -y sqlmap 

    return 0
}
################
install_metasploit() {
    echo
    echo "[+] installing metasploit .."
    echo
    mkdir -p /opt/metasploit && cd /opt/metasploit
    git clone https://github.com/rapid7/metasploit-framework.git
    cd metasploit-framework/
    gem install bundler
    bundle install # should b done as LOCAL_USER
    if [ "$?" -eq "0" ]; then
        ln -s ./msfconsole /usr/bin/msfconsole
    else
        echo "[+] metasploit did not install correctly."
    fi
    

    return 0
}
################
install_nmap() {
    echo "[+] installing nmap .."
    echo
    ${APT} install -y nmap 

    return 0
}
################
install_wpscan() {
    echo "[+] installing wpscan .."
    echo
    apt install ruby-full
    gem install wpscan
    wpscan --version 

    return 0
}
################
install_sipvicious() {
    echo "[+] installing sipvicious .."
    $(which pip3) install sipvicious

    return 0
}
################
install_hydra() {
    echo
    echo "[+] installing hydra .."
    ${APT} install -y hydra

    return 0
}
#################

install_pent_utils
install_pentest_utils() {
    echo '############### installing pentest utils ###############'
    for util in ${pentest_utils_array[*]}; do
        if [[ "$util" == *sqlmap* ]] ; then
            install_sqlmap
        elif [[ "$util" == *metasploit* ]] ; then
            install_metasploit
        elif [[ "$util" == *nmap* ]] ; then
            install_nmap
        elif [[ "$util" == *wpscan* ]] ; then
            install_wpscan
        elif [[ "$util" == *sipvicious* ]] ; then
            install_sipvicious
        elif [[ "$util" == *hydra* ]] ; then
            install_hydra
        else 
            echo 
            echo "[+] installing ${util} .."
            ${APT} -y install ${util} 2>>./error.log
        fi

    done
    echo

    return 0
}

